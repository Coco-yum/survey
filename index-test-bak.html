<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>产品方案部规划主题SOP优先级调研问卷</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .tab-container {
            margin-top: 30px;
        }
        .tab-buttons {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }
        .tab-button {
            padding: 10px 20px;
            background-color: #f2f2f2;
            border: none;
            cursor: pointer;
            font-size: 16px;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            transition: all 0.3s;
        }
        .tab-button:hover {
            background-color: #e0e0e0;
        }
        .tab-button.active {
            background-color: #3498db;
            color: white;
        }
        .tab-content {
            display: none;
            padding: 15px;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 5px 5px;
        }
        .tab-content.active {
            display: block;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
            position: sticky;
            top: 0;
        }
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .required:after {
            content: " *";
            color: red;
        }
        .section-description {
            background-color: #eaf7fd;
            padding: 10px;
            border-left: 4px solid #3498db;
            margin-bottom: 15px;
        }
        .submit-btn {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            display: block;
            margin: 20px auto;
        }
        .submit-btn:hover {
            background-color: #2980b9;
        }
        .submit-btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        textarea {
            width: 100%;
            min-height: 60px;
            resize: vertical;
        }
        .checkbox-cell {
            text-align: center;
        }
        input[type="checkbox"] {
            transform: scale(1.2);
        }
        .rating {
            display: flex;
            justify-content: center;
            gap: 5px;
        }
        .rating input {
            display: none;
        }
        .rating label {
            cursor: pointer;
            font-size: 20px;
            color: #ccc;
        }
        .rating input:checked ~ label {
            color: #f5d442;
        }
        .rating label:hover,
        .rating label:hover ~ label {
            color: #f5d442;
        }
        .warning-message {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 15px;
            border-left: 4px solid #ffeeba;
        }
    </style>
</head>
<body>
    <h1>产品方案部规划主题SOP优先级调研问卷</h1>
    
    <div class="warning-message">
        <strong>重要提示：</strong>本问卷每个IP地址只能提交一次，请确保完成所有季度评估后再提交。提交后将无法修改。
    </div>
    
    <p>请您根据专业判断，对各季度规划主题进行全面评估。我们特别重视您的宝贵意见，请在满意度评分和补充建议栏中尽可能详细地提供您的看法和建议，包括但不限于：内容改进方向、实际应用场景建议、潜在问题分析等。您的反馈将直接影响我们后续的工作重点和方向。</p>
    
    <form id="surveyForm" action="https://formsubmit.co/ren_cola@163.com" method="POST">
        <input type="hidden" name="_captcha" value="false">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_subject" value="产品方案部规划主题SOP优先级调研问卷提交">
        <input type="hidden" name="user_ip" id="userIp">
        <input type="hidden" name="submission_time" id="submissionTime">
        <input type="text" name="_honey" style="display:none">
        
        <div class="tab-container">
            <div class="tab-buttons">
                <button type="button" class="tab-button active" onclick="openTab(event, 'q1')">第一季度 (Q1)</button>
                <button type="button" class="tab-button" onclick="openTab(event, 'q2')">第二季度 (Q2)</button>
                <button type="button" class="tab-button" onclick="openTab(event, 'q3')">第三季度 (Q3)</button>
                <button type="button" class="tab-button" onclick="openTab(event, 'q4')">第四季度 (Q4)</button>
            </div>
            
            <!-- Q1 Section -->
            <div id="q1" class="tab-content active">
                <div class="section-description">
                    <p>第一季度已经完成11个主题的编写和培训，请对我们提供的内容进行满意度评估：</p>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th width="7%">编号</th>
                            <th width="15%">规划主题</th>
                            <th width="40%">主要内容</th>
                            <th width="5%">月份</th>
                            <th width="10%">满意度评分</th>
                            <th width="23%">改进建议</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SOP-01</td>
                            <td>抗菌药品医嘱在临床应用V2.0</td>
                            <td>门诊、急诊、住院业务流程中，抗菌药品医嘱的应用，按业务分类及对应场景进行整理，包括三级管理、围手术期、联合用药业务下场景模式，及对应配置方案及系统实现效果</td>
                            <td>3月</td>
                            <td class="checkbox-cell">
                                <div class="rating">
                                    <input type="radio" id="star5_SOP-01" name="rating_SOP-01" value="1">
                                    <label for="star5_SOP-01">★</label>
                                    <input type="radio" id="star4_SOP-01" name="rating_SOP-01" value="2">
                                    <label for="star4_SOP-01">★</label>
                                    <input type="radio" id="star3_SOP-01" name="rating_SOP-01" value="3">
                                    <label for="star3_SOP-01">★</label>
                                    <input type="radio" id="star2_SOP-01" name="rating_SOP-01" value="4">
                                    <label for="star2_SOP-01">★</label>
                                    <input type="radio" id="star1_SOP-01" name="rating_SOP-01" value="5">
                                    <label for="star1_SOP-01">★</label>
                                </div>
                            </td>
                            <td><textarea name="suggestion_SOP-01" placeholder="请详细说明改进建议，如内容准确性、实用性、应用场景等方面"></textarea></td>
                        </tr>
                        <tr>
                            <td>SOP-05</td>
                            <td>双通道药品业务流程</td>
                            <td>1、双通道药品的政策背景；2、双通道处方流转管理系统的功能介绍；3、基于双通道处方流转系统的三种实现模式：虚拟药房模式、共用现药房模式、独立开方模式；4、三种模式的优劣势与推荐</td>
                            <td>3月</td>
                            <td class="checkbox-cell">
                                <div class="rating">
                                    <input type="radio" id="star5_SOP-01" name="rating_SOP-01" value="1">
                                    <label for="star5_SOP-01">★</label>
                                    <input type="radio" id="star4_SOP-01" name="rating_SOP-01" value="2">
                                    <label for="star4_SOP-01">★</label>
                                    <input type="radio" id="star3_SOP-01" name="rating_SOP-01" value="3">
                                    <label for="star3_SOP-01">★</label>
                                    <input type="radio" id="star2_SOP-01" name="rating_SOP-01" value="4">
                                    <label for="star2_SOP-01">★</label>
                                    <input type="radio" id="star1_SOP-01" name="rating_SOP-01" value="5">
                                    <label for="star1_SOP-05">★</label>
                                </div>
                            </td>
                            <td><textarea name="suggestion_SOP-05" placeholder="请详细说明改进建议，如内容准确性、实用性、应用场景等方面"></textarea></td>
                        </tr>
                        <tr>
                            <td>SOP-34</td>
                            <td>GCP患者门诊住院业务流程</td>
                            <td>1、GCP模式分类（采购卫宁GCP、采购三方GCP、无GCP情况）；2、各类模式在5X和60系上的对比以及实现流程和效果；3、相关GCP项目管理和配置</td>
                            <td>3月</td>
                            <td class="checkbox-cell">
                                <div class="rating">
                                    <input type="radio" id="star5_SOP-01" name="rating_SOP-01" value="1">
                                    <label for="star5_SOP-01">★</label>
                                    <input type="radio" id="star4_SOP-01" name="rating_SOP-01" value="2">
                                    <label for="star4_SOP-01">★</label>
                                    <input type="radio" id="star3_SOP-01" name="rating_SOP-01" value="3">
                                    <label for="star3_SOP-01">★</label>
                                    <input type="radio" id="star2_SOP-01" name="rating_SOP-01" value="4">
                                    <label for="star2_SOP-01">★</label>
                                    <input type="radio" id="star1_SOP-01" name="rating_SOP-01" value="5">
                                    <label for="star1_SOP-34">★</label>
                                </div>
                            </td>
                            <td><textarea name="suggestion_SOP-34" placeholder="请详细说明改进建议，如内容准确性、实用性、应用场景等方面"></textarea></td>
                        </tr>
                
                        <tr>
                            <td>SOP-75</td>
                            <td>过敏与皮试业务流程V2.0</td>
                            <td>补充V1版本内容，1、皮试模式分类（①线下皮试模式；②先皮试后治疗；③皮试联动治疗；④皮试作为治疗项目）；2、各模式分类的对比及实现效果</td>
                            <td>3月</td>
                            <td class="checkbox-cell">
                                <div class="rating">
                                    <input type="radio" id="star5_SOP-01" name="rating_SOP-01" value="1">
                                    <label for="star5_SOP-01">★</label>
                                    <input type="radio" id="star4_SOP-01" name="rating_SOP-01" value="2">
                                    <label for="star4_SOP-01">★</label>
                                    <input type="radio" id="star3_SOP-01" name="rating_SOP-01" value="3">
                                    <label for="star3_SOP-01">★</label>
                                    <input type="radio" id="star2_SOP-01" name="rating_SOP-01" value="4">
                                    <label for="star2_SOP-01">★</label>
                                    <input type="radio" id="star1_SOP-01" name="rating_SOP-01" value="5">
                                    <label for="star1_SOP-75">★</label>
                                </div>
                            </td>
                            <td><textarea name="suggestion_SOP-75" placeholder="请详细说明改进建议，如内容准确性、实用性、应用场景等方面"></textarea></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Q2 Section -->
            <div id="q2" class="tab-content">
                <div class="section-description">
                    <p>第二季度共计划32个主题编写，具体月份安排见下表4月、5月、6月份规划主题，请评估必要性，并对主要内容进行建议补充：</p>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th width="7%">编号</th>
                            <th width="15%">规划主题</th>
                            <th width="40%">主要内容</th>
                            <th width="5%">月份</th>
                            <th width="5%">必要性</th>
                            <th width="28%">补充建议</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SOP-14</td>
                            <td>不拆零药品管理模式及应用</td>
                            <td>1、不可拆零药品管理概述（包括定义、重要性等）<br>2、药品场景分类包括：口服类、注射类、外用类<br>3、推荐发放模式：临时领药+长期执行模式、用自理药加续领（分口服、注射、外用）、累计领药模式、按申请日均摊模式</td>
                            <td>4月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-14"></td>
                            <td><textarea name="suggestion_SOP-14" placeholder="请详细说明您的建议，包括但不限于：内容改进方向、实际应用场景建议、潜在问题分析等"></textarea></td>
                        </tr>
                        <tr>
                            <td>SOP-67</td>
                            <td>住院患者权限管控</td>
                            <td>1、业务介绍：住院过程中患者权限管控业务，包括普通患者-通科、医疗组管理，保密患者、借床患者、跨科治疗患者（不用详细介绍每个跨科业务）、会诊患者、转科转区患者、病案封存（依赖中天病案系统）<br>2、系统功能：目前各个业务系统实现的功能及配置方案，诊断审签、值班授权、跨科治疗患者授权、会诊权限、病历文书权限、护理文书权限、转科转区权限管控、病案封存状态临床权限管控、病案借阅、保密患者权限、患者360</td>
                            <td>4月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-67"></td>
                            <td><textarea name="suggestion_SOP-67"></textarea></td>
                        </tr>
                      
                        <tr>
                            <td>SOP-73</td>
                            <td>高客/IP流程</td>
                            <td>档案、套餐、多价格、排队、商保，提炼现有实现，面向市场民营医院，有市场价值。公立医院面向特需业务。</td>
                            <td>6月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-73"></td>
                            <td><textarea name="suggestion_SOP-73"></textarea></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Q3 Section -->
            <div id="q3" class="tab-content">
                <div class="section-description">
                    <p>第三季度共计划27个主题编写，具体月份安排见下表7月、8月、9月份规划主题，请评估必要性，并对主要内容进行建议补充：</p>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th width="7%">编号</th>
                            <th width="15%">规划主题</th>
                            <th width="40%">主要内容</th>
                            <th width="5%">月份</th>
                            <th width="5%">必要性</th>
                            <th width="28%">补充建议</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SOP-35</td>
                            <td>日间手术SOP</td>
                            <td>1、预住院模式下的日间手术；2、非预住院模式下的日间手术；3、日间手术开立、排程、麻醉评估；4、预住院流程的对接；5、不满足日间指征时退出日间的管理；6、按虚拟病区管理日间手术患者</td>
                            <td>7月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-35"></td>
                            <td><textarea name="suggestion_SOP-35"></textarea></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Q4 Section -->
            <div id="q4" class="tab-content">
                <div class="section-description">
                    <p>第四季度共计划20个主题编写，具体月份安排见下表10月、11月、12月份规划主题，请评估必要性，并对主要内容进行建议补充：</p>
                </div>
                
                <table>
                    <thead>
                        <tr>
                            <th width="7%">编号</th>
                            <th width="15%">规划主题</th>
                            <th width="40%">主要内容</th>
                            <th width="5%">月份</th>
                            <th width="5%">必要性</th>
                            <th width="28%">补充建议</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>SOP-64</td>
                            <td>胃肠镜整体业务解决方案</td>
                            <td>1、覆盖门诊患者和住院患者，在进行胃肠镜检查时对于病理申请单的开立流程 2、无痛胃肠镜业务中遇到的麻醉评估及麻醉类药品的开立及领药计费业务流程</td>
                            <td>10月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-64"></td>
                            <td><textarea name="suggestion_SOP-64"></textarea></td>
                        </tr>
                     
                        <tr>
                            <td>SOP-90</td>
                            <td>转运交接流程</td>
                            <td>移动护理转运交接标准流程，包含治疗转运、手术转运、病区转运以及出入区；</td>
                            <td>12月</td>
                            <td class="checkbox-cell"><input type="checkbox" name="necessity_SOP-90"></td>
                            <td><textarea name="suggestion_SOP-90"></textarea></td>
                        </tr>
                    </tbody>
                </table>
                
                <!-- 只在Q4显示提交按钮 -->
                <button type="submit" class="submit-btn" id="submitBtn">提交问卷</button>
                <div class="warning-message">
                    <strong>请确认：</strong>您已完成所有季度的评估吗？提交后将无法修改。每个IP地址只能提交一次。
                </div>
            </div>
        </div>
    </form>

    <script>
        // 获取用户IP地址
        async function getUserIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                console.error('获取IP地址失败:', error);
                return 'unknown';
            }
        }

        // 检查是否已提交过
        function checkIfSubmitted() {
            const submitted = localStorage.getItem('surveySubmitted');
            if (submitted === 'true') {
                alert('您已经提交过问卷，每个IP地址只能提交一次。');
                document.getElementById('submitBtn').disabled = true;
                // 禁用所有表单元素
                const formElements = document.querySelectorAll('#surveyForm input, #surveyForm textarea, #surveyForm button');
                formElements.forEach(element => {
                    element.disabled = true;
                });
                return true;
            }
            return false;
        }

        // 页面加载时执行
        document.addEventListener('DOMContentLoaded', async function() {
            // 检查是否已提交
            checkIfSubmitted();
            
            // 获取并设置用户IP
            const userIp = await getUserIP();
            document.getElementById('userIp').value = userIp;
            
            // 设置提交时间
            const now = new Date();
            document.getElementById('submissionTime').value = now.toISOString();
        });

        function openTab(evt, tabName) {
            // 隐藏所有tab内容
            var tabContents = document.getElementsByClassName("tab-content");
            for (var i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            // 移除所有tab按钮的active类
            var tabButtons = document.getElementsByClassName("tab-button");
            for (var i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            // 显示当前tab内容并激活按钮
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        document.getElementById('surveyForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 确认用户是否真的要提交
            if (!confirm('确定要提交问卷吗？提交后将无法修改。')) {
                return;
            }
            
            // 标记为已提交
            localStorage.setItem('surveySubmitted', 'true');
            
            // 动态修改表单的 action（确保 FormSubmit 能处理）
            this.action = 'https://formsubmit.co/ren_cola@163.com';
            
            // 提交表单
            this.submit();
            
            // 显示提交成功信息
            alert('感谢您的参与！问卷已提交。');
            
            // 禁用提交按钮
            document.getElementById('submitBtn').disabled = true;
        });
    </script>
</body>
</html>
